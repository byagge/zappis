<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resso - Редактор сайта</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .editor-preview {
            transform: scale(0.8);
            transform-origin: top center;
            transition: all 0.3s ease;
        }
        .editor-preview:hover {
            transform: scale(0.85);
        }
        .section-dragging {
            opacity: 0.5;
        }
        .section-drag-handle {
            cursor: move;
        }
    </style>
</head>
<body class="h-screen bg-gray-50 flex" style="font-family: system-ui, -apple-system, sans-serif;">
    <div x-data="editorPage()">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between fixed top-0 left-0 right-0 z-50 shadow-sm">
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">R</span>
                    </div>
                    <span class="font-semibold text-gray-900">Resso</span>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button @click="saveChanges" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                    <i data-lucide="save" class="w-4 h-4"></i>
                    <span>Сохранить</span>
                </button>
                <button @click="previewSite" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-2">
                    <i data-lucide="eye" class="w-4 h-4"></i>
                    <span>Предпросмотр</span>
                </button>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200 p-4 space-y-6 fixed left-0 top-16 bottom-0 overflow-y-auto no-scrollbar z-40">
            <!-- Навигация -->
            <div class="pt-2">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-medium text-gray-900">Навигация</h3>
                </div>
                <div class="space-y-1.5">
                    <a href="index.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="home" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Главная</span>
                    </a>
                    <a href="create.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="plus-circle" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Создать сайт</span>
                    </a>
                    <a href="templates.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="layout" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Шаблоны</span>
                    </a>
                    <a href="#" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="help-circle" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Помощь</span>
                    </a>
                </div>
            </div>

            <!-- Секции сайта -->
            <div class="pt-4 border-t border-gray-100">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-medium text-gray-900">Секции сайта</h3>
                </div>
                <div class="space-y-2">
                    <template x-for="(section, index) in sections" :key="index">
                        <div class="bg-gray-50 rounded-lg p-3 flex items-center justify-between group"
                             :class="{'ring-2 ring-blue-500': selectedSection === index}">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="grip-vertical" class="w-4 h-4 text-gray-400 section-drag-handle"></i>
                                <span class="text-sm text-gray-700" x-text="section.name"></span>
                            </div>
                            <div class="flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button @click="editSection(index)" class="p-1 text-gray-500 hover:text-gray-700">
                                    <i data-lucide="edit" class="w-4 h-4"></i>
                                </button>
                                <button @click="toggleSection(index)" class="p-1 text-gray-500 hover:text-gray-700">
                                    <i data-lucide="eye-off" x-show="section.visible" class="w-4 h-4"></i>
                                    <i data-lucide="eye" x-show="!section.visible" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 ml-64 pt-16">
            <div class="flex">
                <!-- Editor Panel -->
                <div class="w-96 bg-white border-r border-gray-200 p-6 overflow-y-auto h-screen">
                    <div x-show="selectedSection !== null">
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-2" x-text="sections[selectedSection].name"></h2>
                            <p class="text-sm text-gray-500">Настройте параметры выбранной секции</p>
                        </div>

                        <!-- Шапка -->
                        <template x-if="selectedSection === 0">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Название сайта</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[0].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Логотип</label>
                                    <div class="relative w-16 h-16">
                                        <img x-show="sections[0].content.logo" :src="sections[0].content.logo" class="w-full h-full object-cover rounded-lg">
                                        <div x-show="!sections[0].content.logo" class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                                            <i data-lucide="image" class="w-8 h-8 text-gray-400"></i>
                                        </div>
                                        <input type="file" @change="uploadLogo" class="absolute inset-0 opacity-0 cursor-pointer">
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Главный блок -->
                        <template x-if="selectedSection === 1">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[1].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[1].content.description"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Фоновое изображение</label>
                                    <div class="relative w-32 h-20">
                                        <img x-show="sections[1].content.image" :src="sections[1].content.image" class="w-full h-full object-cover rounded-lg">
                                        <div x-show="!sections[1].content.image" class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                                            <i data-lucide="image" class="w-8 h-8 text-gray-400"></i>
                                        </div>
                                        <input type="file" @change="uploadMainImage" class="absolute inset-0 opacity-0 cursor-pointer">
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Портфолио -->
                        <template x-if="selectedSection === 2">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[2].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Работы</label>
                                    <div class="space-y-3">
                                        <template x-for="(work, index) in sections[2].content.works" :key="index">
                                            <div class="bg-gray-50 rounded-lg p-3">
                                                <div class="flex items-center space-x-3 mb-2">
                                                    <div class="relative w-16 h-16">
                                                        <img x-show="work.image" :src="work.image" class="w-full h-full object-cover rounded-lg">
                                                        <div x-show="!work.image" class="w-full h-full bg-gray-200 rounded-lg flex items-center justify-center">
                                                            <i data-lucide="image" class="w-6 h-6 text-gray-400"></i>
                                                        </div>
                                                        <input type="file" @change="uploadWorkImage(index, $event)" class="absolute inset-0 opacity-0 cursor-pointer">
                                                    </div>
                                                    <div class="flex-1">
                                                        <input type="text" 
                                                               class="w-full border border-gray-300 rounded-lg px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                               x-model="work.title"
                                                               placeholder="Название работы">
                                                    </div>
                                                </div>
                                                <div class="flex justify-end space-x-2">
                                                    <button @click="removeWork(index)" class="p-1 text-red-500 hover:text-red-700">
                                                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </template>
                                        <button @click="addWork" class="w-full px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-center space-x-2">
                                            <i data-lucide="plus" class="w-4 h-4"></i>
                                            <span>Добавить работу</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Контакты -->
                        <template x-if="selectedSection === 3">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[3].content.description"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Телефон</label>
                                    <input type="tel" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.phone">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Адрес</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.address">
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Preview Panel -->
                <div class="flex-1 p-8 overflow-y-auto h-screen">
                    <div class="max-w-4xl mx-auto editor-preview">
                        <!-- Шапка -->
                        <template x-if="sections[0].visible">
                            <header class="bg-white shadow-sm">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                                    <div class="flex justify-between items-center py-6">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 rounded-lg overflow-hidden">
                                                <img x-show="sections[0].content.logo" :src="sections[0].content.logo" class="w-full h-full object-cover">
                                                <div x-show="!sections[0].content.logo" class="w-full h-full bg-blue-600 flex items-center justify-center">
                                                    <span class="text-white font-bold">R</span>
                                                </div>
                                            </div>
                                            <span class="ml-3 text-xl font-semibold text-gray-900" x-text="sections[0].content.title"></span>
                                        </div>
                                        <nav class="flex space-x-8">
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Главная</a>
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Портфолио</a>
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Контакты</a>
                                        </nav>
                                    </div>
                                </div>
                            </header>
                        </template>

                        <!-- Главный блок -->
                        <template x-if="sections[1].visible">
                            <section class="bg-white">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <div class="grid grid-cols-2 gap-12 items-center">
                                        <div>
                                            <h1 class="text-4xl font-bold text-gray-900 mb-4" x-text="sections[1].content.title"></h1>
                                            <p class="text-xl text-gray-600 mb-8" x-text="sections[1].content.description"></p>
                                            <button class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                                Записаться
                                            </button>
                                        </div>
                                        <div class="rounded-lg h-96" :class="{'bg-gray-200': !sections[1].content.image}" :style="sections[1].content.image ? { 'background-image': 'url(' + sections[1].content.image + ')', 'background-size': 'cover', 'background-position': 'center' } : {}"></div>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Портфолио -->
                        <template x-if="sections[2].visible">
                            <section class="bg-gray-50">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="sections[2].content.title"></h2>
                                    <div class="grid grid-cols-3 gap-8">
                                        <template x-for="(work, index) in sections[2].content.works" :key="index">
                                            <div class="bg-white rounded-lg overflow-hidden shadow-sm">
                                                <div class="h-48" :class="{'bg-gray-200': !work.image}" :style="work.image ? { 'background-image': 'url(' + work.image + ')', 'background-size': 'cover', 'background-position': 'center' } : {}"></div>
                                                <div class="p-4">
                                                    <h3 class="font-semibold text-gray-900" x-text="work.title"></h3>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Контакты -->
                        <template x-if="sections[3].visible">
                            <section class="bg-white">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="sections[3].content.title"></h2>
                                    <div class="max-w-2xl mx-auto text-center">
                                        <p class="text-xl text-gray-600 mb-8" x-text="sections[3].content.description"></p>
                                        <div class="space-y-4">
                                            <div class="flex items-center justify-center space-x-2">
                                                <i data-lucide="phone" class="w-5 h-5 text-gray-400"></i>
                                                <span class="text-gray-900" x-text="sections[3].content.phone"></span>
                                            </div>
                                            <div class="flex items-center justify-center space-x-2">
                                                <i data-lucide="map-pin" class="w-5 h-5 text-gray-400"></i>
                                                <span class="text-gray-900" x-text="sections[3].content.address"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Футер -->
                        <footer class="bg-gray-900 text-white">
                            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                                <div class="grid grid-cols-4 gap-8">
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">О компании</h3>
                                        <p class="text-gray-400">Мы создаем красивые и функциональные сайты для вашего бизнеса</p>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Контакты</h3>
                                        <div class="space-y-2 text-gray-400">
                                            <p>Email: info@resso.com</p>
                                            <p>Телефон: +7 (999) 123-45-67</p>
                                        </div>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Навигация</h3>
                                        <div class="space-y-2">
                                            <a href="#" class="text-gray-400 hover:text-white">Главная</a>
                                            <a href="#" class="text-gray-400 hover:text-white">Портфолио</a>
                                            <a href="#" class="text-gray-400 hover:text-white">Контакты</a>
                                        </div>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Социальные сети</h3>
                                        <div class="flex space-x-4">
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="facebook" class="w-5 h-5"></i>
                                            </a>
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="instagram" class="w-5 h-5"></i>
                                            </a>
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="twitter" class="w-5 h-5"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                                    <p>© 2024 Resso. Все права защищены.</p>
                                </div>
                            </div>
                        </footer>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alpine.js Logic -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('editorPage', () => ({
                selectedSection: 0,
                sections: [
                    {
                        name: 'Шапка',
                        visible: true,
                        content: {
                            title: 'Название сайта',
                            logo: null
                        }
                    },
                    {
                        name: 'Главный блок',
                        visible: true,
                        content: {
                            title: 'Заголовок главного блока',
                            description: 'Описание вашего бизнеса или услуги. Расскажите о своих преимуществах и уникальных предложениях.',
                            image: null
                        }
                    },
                    {
                        name: 'Портфолио',
                        visible: true,
                        content: {
                            title: 'Наши работы',
                            works: [
                                { title: 'Работа 1', image: null },
                                { title: 'Работа 2', image: null },
                                { title: 'Работа 3', image: null }
                            ]
                        }
                    },
                    {
                        name: 'Контакты',
                        visible: true,
                        content: {
                            title: 'Свяжитесь с нами',
                            description: 'Мы всегда на связи и готовы ответить на все ваши вопросы',
                            phone: '+7 (999) 123-45-67',
                            address: 'г. Москва, ул. Примерная, д. 1'
                        }
                    }
                ],
                init() {
                    const savedData = localStorage.getItem('siteData');
                    if (savedData) {
                        this.sections = JSON.parse(savedData);
                    }
                },
                editSection(index) {
                    this.selectedSection = index;
                },
                toggleSection(index) {
                    this.sections[index].visible = !this.sections[index].visible;
                },
                addWork() {
                    this.sections[2].content.works.push({
                        title: 'Новая работа',
                        image: null
                    });
                },
                removeWork(index) {
                    this.sections[2].content.works.splice(index, 1);
                },
                uploadLogo(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[0].content.logo = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                uploadMainImage(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[1].content.image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                uploadWorkImage(index, event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[2].content.works[index].image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                saveChanges() {
                    localStorage.setItem('siteData', JSON.stringify(this.sections));
                    console.log('Изменения сохранены');
                },
                previewSite() {
                    console.log('Предпросмотр сайта...');
                    // Здесь можно добавить открытие нового окна для предпросмотра
                }
            }));
        });

        // Инициализация иконок Lucide
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>
</body>
</html>