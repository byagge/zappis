<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resso - Редактор сайта</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .editor-preview {
            transform: scale(0.8);
            transform-origin: top center;
            transition: all 0.3s ease;
        }
        .editor-preview:hover {
            transform: scale(0.85);
        }
        .section-dragging {
            opacity: 0.5;
        }
        .section-drag-handle {
            cursor: move;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="h-screen bg-gray-50 flex" style="font-family: system-ui, -apple-system, sans-serif;">
    <div x-data="editorPage()">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between fixed top-0 left-0 right-0 z-50 shadow-sm">
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">R</span>
                    </div>
                    <span class="font-semibold text-gray-900">Resso</span>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button @click="saveChanges" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                    <i data-lucide="save" class="w-4 h-4"></i>
                    <span>Сохранить</span>
                </button>
                <button @click="previewSite" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-2">
                    <i data-lucide="eye" class="w-4 h-4"></i>
                    <span>Предпросмотр</span>
                </button>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200 p-4 space-y-6 fixed left-0 top-16 bottom-0 overflow-y-auto no-scrollbar z-40">
            <!-- Навигация -->
            <div class="pt-2">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-medium text-gray-900">Навигация</h3>
                </div>
                <div class="space-y-1.5">
                    <a href="index.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="home" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Главная</span>
                    </a>
                    <a href="create.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="plus-circle" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Создать сайт</span>
                    </a>
                    <a href="templates.html" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="layout" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Шаблоны</span>
                    </a>
                    <a href="#" class="nav-item flex items-center space-x-2 px-3 py-2.5 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <i data-lucide="help-circle" class="w-4 h-4 flex-shrink-0"></i>
                        <span>Помощь</span>
                    </a>
                </div>
            </div>

            <!-- Секции сайта -->
            <div class="pt-4 border-t border-gray-100">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-medium text-gray-900">Секции сайта</h3>
                    <button @click="addNewSection" class="p-1 text-gray-500 hover:text-gray-700">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                    </button>
                </div>
                <div class="space-y-2">
                    <template x-for="(section, index) in sections" :key="index">
                        <div class="bg-gray-50 rounded-lg p-3 flex items-center justify-between group cursor-pointer"
                             :class="{'ring-2 ring-blue-500': selectedSection === index}"
                             @click="editSection(index)">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="grip-vertical" class="w-4 h-4 text-gray-400 section-drag-handle"></i>
                                <span class="text-sm text-gray-700" x-text="section.name"></span>
                            </div>
                            <div class="flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button @click.stop="editSection(index)" class="p-1 text-gray-500 hover:text-gray-700">
                                    <i data-lucide="edit" class="w-4 h-4"></i>
                                </button>
                                <button x-show="index > 1" @click.stop="toggleSection(index)" class="p-1 text-gray-500 hover:text-gray-700">
                                    <i data-lucide="eye-off" x-show="section.visible" class="w-4 h-4"></i>
                                    <i data-lucide="eye" x-show="!section.visible" class="w-4 h-4"></i>
                                </button>
                                <button x-show="index > 1" @click.stop="removeSection(index)" class="p-1 text-red-500 hover:text-red-700">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 ml-64 pt-16">
            <div class="flex">
                <!-- Editor Panel -->
                <div class="w-96 bg-white border-r border-gray-200 p-6 overflow-y-auto h-screen">
                    <div x-show="selectedSection !== null">
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-900 mb-2" x-text="sections[selectedSection].name"></h2>
                            <p class="text-sm text-gray-500">Настройте параметры выбранной секции</p>
                        </div>

                        <!-- Шапка -->
                        <template x-if="selectedSection === 0">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Название сайта</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[0].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Логотип</label>
                                    <div class="relative w-16 h-16">
                                        <img x-show="sections[0].content.logo" :src="sections[0].content.logo" class="w-full h-full object-cover rounded-lg">
                                        <div x-show="!sections[0].content.logo" class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                                            <i data-lucide="image" class="w-8 h-8 text-gray-400"></i>
                                        </div>
                                        <input type="file" @change="uploadLogo" class="absolute inset-0 opacity-0 cursor-pointer">
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Главный блок -->
                        <template x-if="selectedSection === 1">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[1].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[1].content.description"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Фоновое изображение</label>
                                    <div class="relative w-32 h-20">
                                        <img x-show="sections[1].content.image" :src="sections[1].content.image" class="w-full h-full object-cover rounded-lg">
                                        <div x-show="!sections[1].content.image" class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                                            <i data-lucide="image" class="w-8 h-8 text-gray-400"></i>
                                        </div>
                                        <input type="file" @change="uploadMainImage" class="absolute inset-0 opacity-0 cursor-pointer">
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Портфолио -->
                        <template x-if="selectedSection === 2">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[2].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Работы</label>
                                    <div class="space-y-3">
                                        <template x-for="(work, index) in sections[2].content.works" :key="index">
                                            <div class="bg-gray-50 rounded-lg p-3">
                                                <div class="flex items-center space-x-3 mb-2">
                                                    <div class="relative w-16 h-16">
                                                        <img x-show="work.image" :src="work.image" class="w-full h-full object-cover rounded-lg">
                                                        <div x-show="!work.image" class="w-full h-full bg-gray-200 rounded-lg flex items-center justify-center">
                                                            <i data-lucide="image" class="w-6 h-6 text-gray-400"></i>
                                                        </div>
                                                        <input type="file" @change="uploadWorkImage(index, $event)" class="absolute inset-0 opacity-0 cursor-pointer">
                                                    </div>
                                                    <div class="flex-1">
                                                        <input type="text" 
                                                               class="w-full border border-gray-300 rounded-lg px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                               x-model="work.title"
                                                               placeholder="Название работы">
                                                    </div>
                                                </div>
                                                <div class="flex justify-end space-x-2">
                                                    <button @click="removeWork(index)" class="p-1 text-red-500 hover:text-red-700">
                                                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </template>
                                        <button @click="addWork" class="w-full px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-center space-x-2">
                                            <i data-lucide="plus" class="w-4 h-4"></i>
                                            <span>Добавить работу</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Услуги -->
                        <template x-if="selectedSection === 3">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[3].content.description"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Телефон</label>
                                    <input type="tel" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.phone">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Адрес</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[3].content.address">
                                </div>
                            </div>
                        </template>

                        <!-- Услуги -->
                        <template x-if="selectedSection === 4">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[4].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[4].content.description"></textarea>
                                </div>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <p class="text-sm text-blue-700">
                                        Услуги автоматически синхронизируются с разделом услуг в личном кабинете. 
                                        Для изменения списка услуг перейдите в раздел "Услуги" в личном кабинете.
                                    </p>
                                </div>
                            </div>
                        </template>

                        <!-- Пользовательский блок -->
                        <template x-if="selectedSection > 4">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Название блока</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[selectedSection].name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Заголовок</label>
                                    <input type="text" 
                                           class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                           x-model="sections[selectedSection].content.title">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                                    <textarea class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                              rows="4"
                                              x-model="sections[selectedSection].content.description"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Фоновое изображение</label>
                                    <div class="relative w-32 h-20">
                                        <img x-show="sections[selectedSection].content.image" :src="sections[selectedSection].content.image" class="w-full h-full object-cover rounded-lg">
                                        <div x-show="!sections[selectedSection].content.image" class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                                            <i data-lucide="image" class="w-8 h-8 text-gray-400"></i>
                                        </div>
                                        <input type="file" @change="uploadCustomSectionImage" class="absolute inset-0 opacity-0 cursor-pointer">
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Preview Panel -->
                <div class="flex-1 p-8 overflow-y-auto h-screen">
                    <div class="max-w-4xl mx-auto editor-preview">
                        <!-- Шапка -->
                        <template x-if="sections[0].visible">
                            <header class="bg-white shadow-sm cursor-pointer" @click="editSection(0)">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                                    <div class="flex justify-between items-center py-6">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 rounded-lg overflow-hidden">
                                                <img x-show="sections[0].content.logo" :src="sections[0].content.logo" class="w-full h-full object-cover">
                                                <div x-show="!sections[0].content.logo" class="w-full h-full bg-blue-600 flex items-center justify-center">
                                                    <span class="text-white font-bold">R</span>
                                                </div>
                                            </div>
                                            <span class="ml-3 text-xl font-semibold text-gray-900" x-text="sections[0].content.title"></span>
                                        </div>
                                        <nav class="flex space-x-8">
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Главная</a>
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Портфолио</a>
                                            <a href="#" class="text-gray-500 hover:text-gray-900">Контакты</a>
                                        </nav>
                                    </div>
                                </div>
                            </header>
                        </template>

                        <!-- Главный блок -->
                        <template x-if="sections[1].visible">
                            <section class="bg-white cursor-pointer" @click="editSection(1)">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <div class="grid grid-cols-2 gap-12 items-center">
                                        <div>
                                            <h1 class="text-4xl font-bold text-gray-900 mb-4" x-text="sections[1].content.title"></h1>
                                            <p class="text-xl text-gray-600 mb-8" x-text="sections[1].content.description"></p>
                                            <button class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                                Записаться
                                            </button>
                                        </div>
                                        <div class="rounded-lg h-96" :class="{'bg-gray-200': !sections[1].content.image}" :style="sections[1].content.image ? { 'background-image': 'url(' + sections[1].content.image + ')', 'background-size': 'cover', 'background-position': 'center' } : {}"></div>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Услуги -->
                        <template x-if="sections[2].visible">
                            <section class="bg-gray-50 cursor-pointer" @click="editSection(2)">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="sections[2].content.title"></h2>
                                    <p class="text-xl text-gray-600 mb-12 text-center" x-text="sections[2].content.description"></p>
                                    <div class="grid grid-cols-3 gap-8">
                                        <template x-for="(service, index) in sections[2].content.services" :key="index">
                                            <div class="bg-white rounded-lg p-6 shadow-sm">
                                                <h3 class="text-xl font-semibold text-gray-900 mb-3" x-text="service.title"></h3>
                                                <p class="text-gray-600" x-text="service.description"></p>
                                            </div>
                                        </template>
                                    </div>
                                    <div class="mt-12 text-center">
                                        <a href="#" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors">
                                            <span>Все услуги</span>
                                            <i data-lucide="arrow-right" class="w-4 h-4 ml-2"></i>
                                        </a>
                                    </div>
                                    <div class="mt-8 text-center text-sm text-gray-500">
                                        <p>* Услуги автоматически синхронизируются с разделом услуг в личном кабинете</p>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Портфолио -->
                        <template x-if="sections[3].visible">
                            <section class="bg-gray-50 cursor-pointer" @click="editSection(3)">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="sections[3].content.title"></h2>
                                    <div class="grid grid-cols-3 gap-8">
                                        <template x-for="(work, index) in sections[3].content.works" :key="index">
                                            <div class="bg-white rounded-lg overflow-hidden shadow-sm">
                                                <div class="h-48" :class="{'bg-gray-200': !work.image}" :style="work.image ? { 'background-image': 'url(' + work.image + ')', 'background-size': 'cover', 'background-position': 'center' } : {}"></div>
                                                <div class="p-4">
                                                    <h3 class="font-semibold text-gray-900" x-text="work.title"></h3>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Контакты -->
                        <template x-if="sections[4].visible">
                            <section class="bg-white cursor-pointer" @click="editSection(4)">
                                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="sections[4].content.title"></h2>
                                    <div class="max-w-2xl mx-auto text-center">
                                        <p class="text-xl text-gray-600 mb-8" x-text="sections[4].content.description"></p>
                                        <div class="space-y-4">
                                            <div class="flex items-center justify-center space-x-2">
                                                <i data-lucide="phone" class="w-5 h-5 text-gray-400"></i>
                                                <span class="text-gray-900" x-text="sections[4].content.phone"></span>
                                            </div>
                                            <div class="flex items-center justify-center space-x-2">
                                                <i data-lucide="map-pin" class="w-5 h-5 text-gray-400"></i>
                                                <span class="text-gray-900" x-text="sections[4].content.address"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </template>

                        <!-- Пользовательские блоки -->
                        <template x-for="(section, index) in sections.slice(5)" :key="index">
                            <template x-if="section.visible">
                                <section class="bg-white cursor-pointer" @click="editSection(index + 5)">
                                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                        <!-- Текстовый блок -->
                                        <template x-if="section.type === 'text'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div x-show="section.content.image" class="max-w-3xl mx-auto">
                                                    <img :src="section.content.image" class="w-full h-auto rounded-lg shadow-sm">
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Услуги -->
                                        <template x-if="section.type === 'services'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="grid grid-cols-3 gap-8">
                                                    <template x-for="(service, serviceIndex) in section.content.services" :key="serviceIndex">
                                                        <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                                            <h3 class="text-xl font-semibold text-gray-900 mb-3" x-text="service.title"></h3>
                                                            <p class="text-gray-600" x-text="service.description"></p>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Портфолио -->
                                        <template x-if="section.type === 'portfolio'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="grid grid-cols-3 gap-8">
                                                    <template x-for="(work, workIndex) in section.content.works" :key="workIndex">
                                                        <div class="bg-white rounded-lg overflow-hidden shadow-sm border border-gray-100">
                                                            <div class="h-48" :class="{'bg-gray-200': !work.image}" :style="work.image ? { 'background-image': 'url(' + work.image + ')', 'background-size': 'cover', 'background-position': 'center' } : {}"></div>
                                                            <div class="p-4">
                                                                <h3 class="font-semibold text-gray-900" x-text="work.title"></h3>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Контакты -->
                                        <template x-if="section.type === 'contacts'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="max-w-2xl mx-auto">
                                                    <div class="grid grid-cols-2 gap-8">
                                                        <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                                            <div class="flex items-center space-x-3 mb-4">
                                                                <i data-lucide="phone" class="w-6 h-6 text-blue-600"></i>
                                                                <span class="text-gray-900" x-text="section.content.phone"></span>
                                                            </div>
                                                            <div class="flex items-center space-x-3 mb-4">
                                                                <i data-lucide="mail" class="w-6 h-6 text-blue-600"></i>
                                                                <span class="text-gray-900" x-text="section.content.email"></span>
                                                            </div>
                                                            <div class="flex items-center space-x-3">
                                                                <i data-lucide="map-pin" class="w-6 h-6 text-blue-600"></i>
                                                                <span class="text-gray-900" x-text="section.content.address"></span>
                                                            </div>
                                                        </div>
                                                        <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Напишите нам</h3>
                                                            <form class="space-y-4">
                                                                <input type="text" placeholder="Ваше имя" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                                                <input type="email" placeholder="Email" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                                                                <textarea placeholder="Сообщение" rows="4" class="w-full border border-gray-300 rounded-lg px-4 py-2"></textarea>
                                                                <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Отправить</button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Социальные сети -->
                                        <template x-if="section.type === 'social'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="flex justify-center space-x-8">
                                                    <template x-for="link in section.content.links" :key="link.platform">
                                                        <a :href="link.url" target="_blank" class="w-16 h-16 bg-gray-50 rounded-xl flex items-center justify-center hover:bg-gray-100 transition-colors">
                                                            <i :data-lucide="link.platform" class="w-8 h-8 text-gray-600"></i>
                                                        </a>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- YouTube видео -->
                                        <template x-if="section.type === 'youtube'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="max-w-3xl mx-auto aspect-w-16 aspect-h-9">
                                                    <iframe :src="'https://www.youtube.com/embed/' + section.content.videoId" 
                                                            class="w-full h-full rounded-xl shadow-sm"
                                                            frameborder="0" 
                                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                                            allowfullscreen></iframe>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Галерея -->
                                        <template x-if="section.type === 'gallery'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="grid grid-cols-3 gap-8">
                                                    <template x-for="(image, imgIndex) in section.content.images" :key="imgIndex">
                                                        <div class="aspect-w-1 aspect-h-1">
                                                            <img :src="image" class="w-full h-full object-cover rounded-xl shadow-sm">
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Отзывы -->
                                        <template x-if="section.type === 'testimonials'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="grid grid-cols-2 gap-8">
                                                    <template x-for="(testimonial, testIndex) in section.content.testimonials" :key="testIndex">
                                                        <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                                            <div class="flex items-center space-x-4 mb-4">
                                                                <div class="w-12 h-12 bg-gray-200 rounded-full"></div>
                                                                <div>
                                                                    <h3 class="font-semibold text-gray-900" x-text="testimonial.name"></h3>
                                                                    <div class="flex items-center">
                                                                        <template x-for="star in 5" :key="star">
                                                                            <i data-lucide="star" class="w-4 h-4" :class="star <= testimonial.rating ? 'text-yellow-400' : 'text-gray-300'"></i>
                                                                        </template>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <p class="text-gray-600" x-text="testimonial.text"></p>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Цены -->
                                        <template x-if="section.type === 'pricing'">
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center" x-text="section.content.title"></h2>
                                                <p class="text-xl text-gray-600 mb-12 text-center" x-text="section.content.description"></p>
                                                <div class="grid grid-cols-3 gap-8">
                                                    <template x-for="(plan, planIndex) in section.content.plans" :key="planIndex">
                                                        <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                                            <h3 class="text-xl font-semibold text-gray-900 mb-2" x-text="plan.name"></h3>
                                                            <div class="text-3xl font-bold text-gray-900 mb-4">
                                                                <span x-text="plan.price"></span>
                                                                <span class="text-lg text-gray-500">₽/мес</span>
                                                            </div>
                                                            <ul class="space-y-3 mb-6">
                                                                <template x-for="(feature, featureIndex) in plan.features" :key="featureIndex">
                                                                    <li class="flex items-center text-gray-600">
                                                                        <i data-lucide="check" class="w-5 h-5 text-green-500 mr-2"></i>
                                                                        <span x-text="feature"></span>
                                                                    </li>
                                                                </template>
                                                            </ul>
                                                            <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Выбрать</button>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </section>
                            </template>
                        </template>

                        <!-- Футер -->
                        <footer class="bg-gray-900 text-white">
                            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                                <div class="grid grid-cols-4 gap-8">
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">О компании</h3>
                                        <p class="text-gray-400">Мы создаем красивые и функциональные сайты для вашего бизнеса</p>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Контакты</h3>
                                        <div class="space-y-2 text-gray-400">
                                            <p>Email: info@resso.com</p>
                                            <p>Телефон: +7 (999) 123-45-67</p>
                                        </div>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Навигация</h3>
                                        <div class="space-y-2">
                                            <a href="#" class="text-gray-400 hover:text-white">Главная</a>
                                            <a href="#" class="text-gray-400 hover:text-white">Портфолио</a>
                                            <a href="#" class="text-gray-400 hover:text-white">Контакты</a>
                                        </div>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-4">Социальные сети</h3>
                                        <div class="flex space-x-4">
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="facebook" class="w-5 h-5"></i>
                                            </a>
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="instagram" class="w-5 h-5"></i>
                                            </a>
                                            <a href="#" class="text-gray-400 hover:text-white">
                                                <i data-lucide="twitter" class="w-5 h-5"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                                    <p>© 2024 Resso. Все права защищены.</p>
                                </div>
                            </div>
                        </footer>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно выбора типа блока -->
        <div x-show="showBlockTypeModal" 
             class="fixed inset-0 z-50 overflow-y-auto"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100"
             x-transition:leave-end="opacity-0">
            <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
                <div class="fixed inset-0 transition-opacity modal-backdrop" aria-hidden="true"></div>
                <div class="inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
                    <div class="bg-white px-6 pt-6 pb-4">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Выберите тип блока</h3>
                            <button @click="showBlockTypeModal = false" class="text-gray-400 hover:text-gray-500">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        </div>
                        <div class="grid grid-cols-3 gap-4">
                            <!-- Стандартные блоки -->
                            <button @click="createBlock('services')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-blue-200 transition-colors">
                                    <i data-lucide="list" class="w-6 h-6 text-blue-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Услуги</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Список услуг с описанием</span>
                            </button>

                            <button @click="createBlock('portfolio')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-purple-200 transition-colors">
                                    <i data-lucide="briefcase" class="w-6 h-6 text-purple-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Портфолио</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Галерея работ</span>
                            </button>

                            <button @click="createBlock('contacts')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-green-200 transition-colors">
                                    <i data-lucide="phone" class="w-6 h-6 text-green-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Контакты</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Контактная информация</span>
                            </button>

                            <!-- Пользовательские блоки -->
                            <button @click="createBlock('text')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-gray-200 transition-colors">
                                    <i data-lucide="file-text" class="w-6 h-6 text-gray-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Текстовый блок</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Заголовок и описание</span>
                            </button>

                            <button @click="createBlock('social')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-pink-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-pink-200 transition-colors">
                                    <i data-lucide="share-2" class="w-6 h-6 text-pink-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Социальные сети</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Ссылки на соц. сети</span>
                            </button>

                            <button @click="createBlock('youtube')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-red-200 transition-colors">
                                    <i data-lucide="youtube" class="w-6 h-6 text-red-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">YouTube видео</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Встроенное видео</span>
                            </button>

                            <button @click="createBlock('gallery')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-yellow-200 transition-colors">
                                    <i data-lucide="image" class="w-6 h-6 text-yellow-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Галерея</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Сетка изображений</span>
                            </button>

                            <button @click="createBlock('testimonials')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-indigo-200 transition-colors">
                                    <i data-lucide="message-square" class="w-6 h-6 text-indigo-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Отзывы</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Отзывы клиентов</span>
                            </button>

                            <button @click="createBlock('pricing')" class="flex flex-col items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors group">
                                <div class="w-12 h-12 bg-teal-100 rounded-xl flex items-center justify-center mb-3 group-hover:bg-teal-200 transition-colors">
                                    <i data-lucide="tag" class="w-6 h-6 text-teal-600"></i>
                                </div>
                                <span class="text-sm font-medium text-gray-900">Цены</span>
                                <span class="text-xs text-gray-500 mt-1 text-center">Тарифы и цены</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alpine.js Logic -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('editorPage', () => ({
                selectedSection: 0,
                sections: [
                    {
                        name: 'Шапка',
                        visible: true,
                        content: {
                            title: 'Название сайта',
                            logo: null
                        }
                    },
                    {
                        name: 'Главный блок',
                        visible: true,
                        content: {
                            title: 'Заголовок главного блока',
                            description: 'Описание вашего бизнеса или услуги. Расскажите о своих преимуществах и уникальных предложениях.',
                            image: null
                        }
                    },
                    {
                        name: 'Услуги',
                        visible: true,
                        content: {
                            title: 'Наши услуги',
                            description: 'Мы предлагаем широкий спектр услуг для вашего бизнеса',
                            services: [
                                {
                                    title: 'Разработка сайтов',
                                    description: 'Создание современных и функциональных веб-сайтов'
                                },
                                {
                                    title: 'Дизайн',
                                    description: 'Разработка уникального визуального стиля'
                                },
                                {
                                    title: 'SEO-оптимизация',
                                    description: 'Повышение видимости вашего сайта в поисковых системах'
                                }
                            ]
                        }
                    },
                    {
                        name: 'Портфолио',
                        visible: true,
                        content: {
                            title: 'Наши работы',
                            works: [
                                { title: 'Работа 1', image: null },
                                { title: 'Работа 2', image: null },
                                { title: 'Работа 3', image: null }
                            ]
                        }
                    },
                    {
                        name: 'Контакты',
                        visible: true,
                        content: {
                            title: 'Свяжитесь с нами',
                            description: 'Мы всегда на связи и готовы ответить на все ваши вопросы',
                            phone: '+7 (999) 123-45-67',
                            address: 'г. Москва, ул. Примерная, д. 1'
                        }
                    }
                ],
                showBlockTypeModal: false,
                init() {
                    // Очищаем localStorage при инициализации
                    localStorage.clear();
                    
                    // Загружаем данные из localStorage (если есть)
                    const savedData = localStorage.getItem('siteData');
                    if (savedData) {
                        this.sections = JSON.parse(savedData);
                    }
                },
                editSection(index) {
                    this.selectedSection = index;
                },
                toggleSection(index) {
                    if (index > 1) {
                        this.sections[index].visible = !this.sections[index].visible;
                    }
                },
                addWork() {
                    this.sections[2].content.works.push({
                        title: 'Новая работа',
                        image: null
                    });
                },
                removeWork(index) {
                    this.sections[2].content.works.splice(index, 1);
                },
                uploadLogo(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[0].content.logo = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                uploadMainImage(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[1].content.image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                uploadWorkImage(index, event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[2].content.works[index].image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                saveChanges() {
                    localStorage.setItem('siteData', JSON.stringify(this.sections));
                    console.log('Изменения сохранены');
                },
                previewSite() {
                    console.log('Предпросмотр сайта...');
                    // Здесь можно добавить открытие нового окна для предпросмотра
                },
                addNewSection() {
                    this.showBlockTypeModal = true;
                },
                removeSection(index) {
                    if (confirm('Вы уверены, что хотите удалить этот блок?')) {
                        this.sections.splice(index, 1);
                        if (this.selectedSection === index) {
                            this.selectedSection = null;
                        }
                    }
                },
                uploadCustomSectionImage(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.sections[this.selectedSection].content.image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },
                createBlock(type) {
                    let newBlock = {
                        name: 'Новый блок',
                        visible: true,
                        type: type,
                        content: {}
                    };

                    switch(type) {
                        case 'services':
                            newBlock.content = {
                                title: 'Наши услуги',
                                description: 'Мы предлагаем широкий спектр услуг',
                                services: [
                                    { title: 'Услуга 1', description: 'Описание услуги 1' },
                                    { title: 'Услуга 2', description: 'Описание услуги 2' },
                                    { title: 'Услуга 3', description: 'Описание услуги 3' }
                                ]
                            };
                            break;
                        case 'portfolio':
                            newBlock.content = {
                                title: 'Наши работы',
                                description: 'Примеры наших проектов',
                                works: [
                                    { title: 'Работа 1', image: null },
                                    { title: 'Работа 2', image: null },
                                    { title: 'Работа 3', image: null }
                                ]
                            };
                            break;
                        case 'contacts':
                            newBlock.content = {
                                title: 'Контакты',
                                description: 'Свяжитесь с нами',
                                phone: '+7 (999) 123-45-67',
                                email: 'info@example.com',
                                address: 'г. Москва, ул. Примерная, д. 1'
                            };
                            break;
                        case 'text':
                            newBlock.content = {
                                title: 'Заголовок блока',
                                description: 'Описание блока',
                                image: null
                            };
                            break;
                        case 'social':
                            newBlock.content = {
                                title: 'Мы в социальных сетях',
                                description: 'Следите за нашими новостями',
                                links: [
                                    { platform: 'facebook', url: '' },
                                    { platform: 'instagram', url: '' },
                                    { platform: 'twitter', url: '' },
                                    { platform: 'youtube', url: '' }
                                ]
                            };
                            break;
                        case 'youtube':
                            newBlock.content = {
                                title: 'Наше видео',
                                description: 'Описание видео',
                                videoId: ''
                            };
                            break;
                        case 'gallery':
                            newBlock.content = {
                                title: 'Галерея',
                                description: 'Наши работы',
                                images: []
                            };
                            break;
                        case 'testimonials':
                            newBlock.content = {
                                title: 'Отзывы клиентов',
                                description: 'Что говорят о нас',
                                testimonials: [
                                    { name: 'Иван Иванов', text: 'Отличный сервис!', rating: 5 },
                                    { name: 'Петр Петров', text: 'Очень доволен!', rating: 5 }
                                ]
                            };
                            break;
                        case 'pricing':
                            newBlock.content = {
                                title: 'Тарифы',
                                description: 'Выберите подходящий тариф',
                                plans: [
                                    { name: 'Базовый', price: '1000', features: ['Функция 1', 'Функция 2'] },
                                    { name: 'Стандарт', price: '2000', features: ['Функция 1', 'Функция 2', 'Функция 3'] },
                                    { name: 'Премиум', price: '3000', features: ['Все функции'] }
                                ]
                            };
                            break;
                    }

                    this.sections.push(newBlock);
                    this.selectedSection = this.sections.length - 1;
                    this.showBlockTypeModal = false;
                }
            }));
        });

        // Инициализация иконок Lucide
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>
</body>
</html>