<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resso CRM - Услуги</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-gray-50" x-data="servicesPage()">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-40">
        <div class="w-full px-6">
            <div class="flex items-center justify-between h-16">
                <!-- Logo and Search -->
                <div class="flex items-center space-x-8">
                    <div class="flex items-center space-x-2">
                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-sm">
                            <span class="text-white font-bold text-xl">R</span>
                        </div>
                        <span class="text-xl font-semibold text-gray-900">Resso CRM</span>
                    </div>
                </div>

                <!-- Right Side Actions -->
                <div class="flex items-center space-x-6">
                    <button class="text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i data-lucide="bell" class="w-5 h-5"></i>
                    </button>
                    <button class="text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                    </button>
                    <div class="flex items-center space-x-3 pl-6 border-l border-gray-200">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-sm">
                            <span class="text-white text-sm font-medium">AP</span>
                        </div>
                        <div class="hidden md:block">
                            <p class="text-sm font-medium text-gray-900">Анна Петрова</p>
                            <p class="text-xs text-gray-500">Администратор</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-gray-200 p-4 space-y-6 fixed left-0 top-16 bottom-0 overflow-y-auto no-scrollbar z-30">
        <!-- Навигация -->
        <div>
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Навигация</h3>
            <nav class="space-y-1">
                <a href="index.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="home" class="w-5 h-5"></i>
                    <span>Главная</span>
                </a>
                <a href="emploee.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="users" class="w-5 h-5"></i>
                    <span>Сотрудники</span>
                </a>
                <a href="clients.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="user-plus" class="w-5 h-5"></i>
                    <span>Клиенты</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="calendar" class="w-5 h-5"></i>
                    <span>Записи</span>
                </a>
                <a href="services.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg bg-blue-50 text-blue-600">
                    <i data-lucide="scissors" class="w-5 h-5"></i>
                    <span>Услуги</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="dollar-sign" class="w-5 h-5"></i>
                    <span>Финансы</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
                    <span>Отчеты</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                    <span>Настройки</span>
                </a>
            </nav>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-auto ml-64 p-6 mt-16">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-2xl font-bold text-gray-900">Услуги</h1>
                <p class="text-gray-500">Управление услугами и категориями</p>
            </div>
            <div class="flex items-center space-x-3">
                <button @click="showAddCategoryModal = true" class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-2">
                    <i data-lucide="folder-plus" class="w-4 h-4"></i>
                    <span>Добавить категорию</span>
                </button>
                <button @click="showAddServiceModal = true" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
                    <i data-lucide="plus" class="w-4 h-4"></i>
                    <span>Добавить услугу</span>
                </button>
            </div>
        </div>

        <!-- Categories and Services -->
        <div class="grid grid-cols-1 gap-6">
            <template x-for="category in categories" :key="category.id">
                <div class="bg-white rounded-xl p-6">
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center space-x-3">
                            <i data-lucide="folder" class="w-5 h-5 text-blue-600"></i>
                            <h2 class="text-lg font-semibold text-gray-900" x-text="category.name"></h2>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button @click="editCategory(category)" class="text-gray-400 hover:text-gray-600">
                                <i data-lucide="edit" class="w-4 h-4"></i>
                            </button>
                            <button @click="deleteCategory(category.id)" class="text-gray-400 hover:text-red-600">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-500 mb-4" x-text="category.description"></p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <template x-for="service in category.services" :key="service.id">
                            <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-500 transition-colors">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h3 class="font-medium text-gray-900" x-text="service.name"></h3>
                                        <p class="text-sm text-gray-500" x-text="service.duration"></p>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button @click="editService(service)" class="text-gray-400 hover:text-gray-600">
                                            <i data-lucide="edit" class="w-4 h-4"></i>
                                        </button>
                                        <button @click="deleteService(service.id)" class="text-gray-400 hover:text-red-600">
                                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-lg font-semibold text-gray-900" x-text="service.price"></span>
                                    <span :class="service.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'" class="px-2 py-1 text-xs rounded-full" x-text="service.isActive ? 'Активна' : 'Неактивна'"></span>
                                </div>
                                <p class="text-gray-500 mt-2" x-text="service.description"></p>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </div>
    </main>

    <!-- Add Service Modal -->
    <div x-show="showAddServiceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Добавить услугу</h3>
                <button @click="showAddServiceModal = false" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <form @submit.prevent="submitService" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Название услуги</label>
                    <input type="text" x-model="serviceForm.name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Категория</label>
                    <select x-model="serviceForm.categoryId" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Выберите категорию</option>
                        <template x-for="category in categories" :key="category.id">
                            <option :value="category.id" x-text="category.name"></option>
                        </template>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Цена</label>
                    <input type="number" x-model="serviceForm.price" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Длительность (минуты)</label>
                    <input type="number" x-model="serviceForm.duration" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                    <textarea x-model="serviceForm.description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" x-model="serviceForm.isActive" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label class="ml-2 text-sm text-gray-700">Активная услуга</label>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" @click="showAddServiceModal = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Отмена
                    </button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        Добавить
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div x-show="showAddCategoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Добавить категорию</h3>
                <button @click="showAddCategoryModal = false" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <form @submit.prevent="submitCategory" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Название категории</label>
                    <input type="text" x-model="categoryForm.name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                    <textarea x-model="categoryForm.description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3"></textarea>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" @click="showAddCategoryModal = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Отмена
                    </button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        Добавить
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Service Modal -->
    <div x-show="showEditServiceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Редактировать услугу</h3>
                <button @click="showEditServiceModal = false" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <form @submit.prevent="submitEditService" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Название услуги</label>
                    <input type="text" x-model="editServiceForm.name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Категория</label>
                    <select x-model="editServiceForm.categoryId" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Выберите категорию</option>
                        <template x-for="category in categories" :key="category.id">
                            <option :value="category.id" x-text="category.name"></option>
                        </template>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Цена</label>
                    <input type="number" x-model="editServiceForm.price" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Длительность (минуты)</label>
                    <input type="number" x-model="editServiceForm.duration" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                    <textarea x-model="editServiceForm.description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" x-model="editServiceForm.isActive" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label class="ml-2 text-sm text-gray-700">Активная услуга</label>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" @click="showEditServiceModal = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">Отмена</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Category Modal -->
    <div x-show="showEditCategoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Редактировать категорию</h3>
                <button @click="showEditCategoryModal = false" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <form @submit.prevent="submitEditCategory" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Название категории</label>
                    <input type="text" x-model="editCategoryForm.name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Описание</label>
                    <textarea x-model="editCategoryForm.description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3"></textarea>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" @click="showEditCategoryModal = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">Отмена</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Сохранить</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div x-show="showConfirmModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-sm">
            <div class="flex items-center mb-4">
                <i data-lucide="alert-triangle" class="w-6 h-6 text-red-500 mr-3"></i>
                <h3 class="text-lg font-semibold text-gray-900" x-text="confirmModalTitle"></h3>
            </div>
            <p class="text-gray-700 mb-6" x-text="confirmModalText"></p>
            <div class="flex justify-end space-x-3">
                <button @click="showConfirmModal = false" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">Отмена</button>
                <button @click="confirmDelete" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Удалить</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div x-show="showSuccessModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 w-full max-w-sm text-center">
            <div class="flex flex-col items-center mb-4">
                <i data-lucide="check-circle" class="w-10 h-10 text-green-500 mb-2"></i>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Успешно!</h3>
                <p class="text-gray-700" x-text="successModalText"></p>
            </div>
            <button @click="showSuccessModal = false" class="mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Ок</button>
        </div>
    </div>

    <!-- Initialize Lucide Icons -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });

        // Alpine.js Component
        function servicesPage() {
            return {
                showAddServiceModal: false,
                showAddCategoryModal: false,
                showEditServiceModal: false,
                showEditCategoryModal: false,
                showConfirmModal: false,
                showSuccessModal: false,
                serviceForm: {
                    name: '',
                    categoryId: '',
                    price: '',
                    duration: '',
                    description: '',
                    isActive: true
                },
                categoryForm: {
                    name: '',
                    description: ''
                },
                editServiceForm: {
                    name: '',
                    categoryId: '',
                    price: '',
                    duration: '',
                    description: '',
                    isActive: true
                },
                editCategoryForm: {
                    name: '',
                    description: ''
                },
                categories: [
                    {
                        id: 1,
                        name: 'Стрижки',
                        description: 'Все виды стрижек',
                        services: [
                            {
                                id: 1,
                                name: 'Женская стрижка',
                                price: '₽ 3,000',
                                duration: '1 час',
                                description: 'Стрижка с учетом типа волос и формы лица',
                                isActive: true
                            },
                            {
                                id: 2,
                                name: 'Мужская стрижка',
                                price: '₽ 2,000',
                                duration: '45 минут',
                                description: 'Классическая и современная стрижка',
                                isActive: true
                            }
                        ]
                    },
                    {
                        id: 2,
                        name: 'Окрашивание',
                        description: 'Все виды окрашивания',
                        services: [
                            {
                                id: 3,
                                name: 'Окрашивание в один тон',
                                price: '₽ 5,000',
                                duration: '2 часа',
                                description: 'Окрашивание с использованием профессиональной краски',
                                isActive: true
                            },
                            {
                                id: 4,
                                name: 'Мелирование',
                                price: '₽ 7,000',
                                duration: '3 часа',
                                description: 'Классическое и современное мелирование',
                                isActive: true
                            }
                        ]
                    },
                    {
                        id: 3,
                        name: 'Укладки',
                        description: 'Все виды укладок',
                        services: [
                            {
                                id: 5,
                                name: 'Повседневная укладка',
                                price: '₽ 2,500',
                                duration: '1 час',
                                description: 'Укладка для ежедневного использования',
                                isActive: true
                            },
                            {
                                id: 6,
                                name: 'Вечерняя укладка',
                                price: '₽ 4,000',
                                duration: '1.5 часа',
                                description: 'Праздничная укладка для особых случаев',
                                isActive: true
                            }
                        ]
                    }
                ],

                // Методы для работы с услугами
                submitService() {
                    if (this.serviceForm.name && this.serviceForm.categoryId && this.serviceForm.price) {
                        const categoryIndex = this.categories.findIndex(c => c.id === parseInt(this.serviceForm.categoryId));
                        if (categoryIndex !== -1) {
                            const newService = {
                                id: Date.now(),
                                name: this.serviceForm.name,
                                price: `₽ ${parseInt(this.serviceForm.price).toLocaleString()}`,
                                duration: `${this.serviceForm.duration} минут`,
                                description: this.serviceForm.description,
                                isActive: this.serviceForm.isActive,
                                categoryId: parseInt(this.serviceForm.categoryId)
                            };
                            this.categories[categoryIndex].services = [...this.categories[categoryIndex].services, newService];
                            this.categories = [...this.categories];
                            this.showAddServiceModal = false;
                            this.resetServiceForm();
                            this.successModalText = 'Услуга успешно добавлена!';
                            this.showSuccessModal = true;
                            setTimeout(() => lucide.createIcons(), 0);
                        }
                    }
                },
                editService(service) {
                    this.editServiceForm = {
                        name: service.name,
                        categoryId: service.categoryId || this.getCategoryIdByService(service.id),
                        price: service.price.replace('₽ ', '').replace(/\s/g, ''),
                        duration: service.duration.replace('минут', '').replace('час', '').replace('часа', '').replace('часов', ''),
                        description: service.description,
                        isActive: service.isActive
                    };
                    this.confirmServiceId = service.id;
                    this.showEditServiceModal = true;
                },
                deleteService(serviceId) {
                    this.showConfirmModal = true;
                    this.confirmModalTitle = 'Удаление услуги';
                    this.confirmModalText = 'Вы уверены, что хотите удалить эту услугу? Все данные будут удалены безвозвратно.';
                    this.confirmServiceId = serviceId;
                },
                resetServiceForm() {
                    this.serviceForm = {
                        name: '',
                        categoryId: '',
                        price: '',
                        duration: '',
                        description: '',
                        isActive: true
                    };
                },

                // Методы для работы с категориями
                submitCategory() {
                    if (this.categoryForm.name) {
                        const newCategory = {
                            id: Date.now(),
                            name: this.categoryForm.name,
                            description: this.categoryForm.description,
                            services: []
                        };
                        this.categories = [...this.categories, newCategory];
                        this.showAddCategoryModal = false;
                        this.resetCategoryForm();
                        this.successModalText = 'Категория успешно добавлена!';
                        this.showSuccessModal = true;
                        setTimeout(() => lucide.createIcons(), 0);
                    }
                },
                editCategory(category) {
                    this.editCategoryForm = {
                        name: category.name,
                        description: category.description
                    };
                    this.confirmCategoryId = category.id;
                    this.showEditCategoryModal = true;
                },
                deleteCategory(categoryId) {
                    this.showConfirmModal = true;
                    this.confirmModalTitle = 'Удаление категории';
                    this.confirmModalText = 'Вы уверены, что хотите удалить эту категорию? Все услуги в ней также будут удалены.';
                    this.confirmCategoryId = categoryId;
                },
                resetCategoryForm() {
                    this.categoryForm = {
                        name: '',
                        description: ''
                    };
                },

                // Методы для работы с подтверждением
                confirmDelete() {
                    if (this.confirmServiceId) {
                        this.categories.forEach(category => {
                            category.services = category.services.filter(service => service.id !== this.confirmServiceId);
                        });
                        this.showConfirmModal = false;
                        setTimeout(() => lucide.createIcons(), 0);
                    } else if (this.confirmCategoryId) {
                        this.categories = this.categories.filter(category => category.id !== this.confirmCategoryId);
                        this.showConfirmModal = false;
                        setTimeout(() => lucide.createIcons(), 0);
                    }
                },

                // Методы для работы с редактированием
                submitEditService() {
                    if (this.editServiceForm.name && this.editServiceForm.categoryId && this.editServiceForm.price) {
                        const category = this.categories.find(c => c.id === parseInt(this.editServiceForm.categoryId));
                        if (category) {
                            const editedService = {
                                id: this.confirmServiceId,
                                name: this.editServiceForm.name,
                                price: `₽ ${parseInt(this.editServiceForm.price).toLocaleString()}`,
                                duration: `${this.editServiceForm.duration} минут`,
                                description: this.editServiceForm.description,
                                isActive: this.editServiceForm.isActive
                            };
                            category.services = category.services.map(service =>
                                service.id === this.confirmServiceId ? editedService : service
                            );
                            this.showEditServiceModal = false;
                            setTimeout(() => lucide.createIcons(), 0);
                        }
                    }
                },
                submitEditCategory() {
                    if (this.editCategoryForm.name) {
                        this.categories = this.categories.map(category => {
                            if (category.id === this.confirmCategoryId) {
                                return {
                                    ...category,
                                    name: this.editCategoryForm.name,
                                    description: this.editCategoryForm.description
                                };
                            }
                            return category;
                        });
                        this.showEditCategoryModal = false;
                        setTimeout(() => lucide.createIcons(), 0);
                    }
                },
                getCategoryIdByService(serviceId) {
                    for (const category of this.categories) {
                        if (category.services.some(service => service.id === serviceId)) {
                            return category.id;
                        }
                    }
                    return '';
                }
            }
        }
    </script>
</body>
</html> 