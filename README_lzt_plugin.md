# LZT Автовыдача - Плагин для Cardinal

Плагин для автоматической выдачи аккаунтов с lzt.market и кодов подтверждения Telegram.

## Установка

1. Установите зависимости:
```bash
pip install -r requirements_lzt.txt
```

2. Скопируйте файл `lzt_autodelivery.py` в папку с плагинами Cardinal.

3. Измените `ADMIN_CHAT_ID` в файле на ваш Telegram chat_id.

## Использование

### Команды администратора:
- `/add_account ID [страна]` - Добавить аккаунт в базу
  - Пример: `/add_account 179560904 RU`

### Команды пользователей:
- `/get_account` - Получить аккаунт
- `/get_code` - Получить код подтверждения
- `/confirm_order` - Подтвердить заказ

## Как это работает

1. **Добавление аккаунтов**: Администратор добавляет ID аккаунтов с lzt.market в базу данных.

2. **Выдача номера**: Когда пользователь запрашивает аккаунт:
   - Плагин ищет свободный аккаунт в базе
   - Переходит на lzt.market/ID/
   - Парсит HTML и достает номер телефона
   - Отправляет номер пользователю

3. **Получение кода**: Когда пользователь запрашивает код:
   - Плагин переходит на lzt.market/ID/telegram-login-code
   - Ищет код с сегодняшней датой
   - Отправляет код пользователю
   - Помечает аккаунт как использованный

## Структура базы данных

```sql
CREATE TABLE accounts (
    id INTEGER PRIMARY KEY,
    lzt_id TEXT UNIQUE,
    country TEXT,
    status TEXT DEFAULT 'available',
    phone TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## Настройка

1. **ADMIN_CHAT_ID**: Замените на ваш Telegram chat_id
2. **Паттерны поиска страны**: Можно изменить в функции `extract_country_from_description()`
3. **User-Agent**: При необходимости измените в функциях `get_phone_number()` и `get_telegram_code()`

## Логирование

Все действия логируются с префиксом `FPC.lzt_autodelivery`.

## Безопасность

- Проверяйте права доступа перед выполнением административных команд
- Не передавайте коды третьим лицам
- Рекомендуется сменить пароль после получения аккаунта

## Устранение неполадок

1. **"Не найден номер"**: Проверьте, что ID аккаунта корректный и доступен на lzt.market
2. **"Код не поступил"**: Подождите, пока код появится на странице
3. **Ошибки парсинга**: Проверьте, что структура HTML на lzt.market не изменилась 