# API –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Zappis

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ Zappis. API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–∏–∑–Ω–µ—Å–æ–º.

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –±–∏–∑–Ω–µ—Å–∞

–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã –±–∏–∑–Ω–µ—Å–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
python create_business_types.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –±–∏–∑–Ω–µ—Å–∞:
- –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã
- –ú–µ–¥–∏—Ü–∏–Ω–∞
- –§–∏—Ç–Ω–µ—Å
- –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- –î—Ä—É–≥–æ–µ

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python manage.py runserver
```

## üîß API Endpoints

### GET /accounts/api/business-types/

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –±–∏–∑–Ω–µ—Å–∞.

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
    "business_types": [
        {"id": 1, "name": "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã"},
        {"id": 2, "name": "–ú–µ–¥–∏—Ü–∏–Ω–∞"},
        {"id": 3, "name": "–§–∏—Ç–Ω–µ—Å"},
        {"id": 4, "name": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"},
        {"id": 5, "name": "–î—Ä—É–≥–æ–µ"}
    ]
}
```

### POST /accounts/api/register/

–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–æ–∑–¥–∞–µ—Ç –±–∏–∑–Ω–µ—Å.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `full_name` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `phone` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (9 —Ü–∏—Ñ—Ä –±–µ–∑ –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã)
- `company_name` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `business_type` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - ID —Ç–∏–ø–∞ –±–∏–∑–Ω–µ—Å–∞
- `password` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)
- `agree_to_terms` (boolean, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –°–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
    "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "phone": "999123456",
    "company_name": "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã '–ö—Ä–∞—Å–æ—Ç–∞'",
    "business_type": "1",
    "password": "mypassword123",
    "agree_to_terms": true
}
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (201):**
```json
{
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "user": {
        "id": "uuid-here",
        "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
        "phone_number": "+996999123456",
        "business": {
            "id": 1,
            "name": "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã '–ö—Ä–∞—Å–æ—Ç–∞'"
        }
    },
    "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
}
```

**–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400):**
```json
{
    "detail": "–í—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python test_register_api.py
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: `http://localhost:8000/accounts/register/`
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É
3. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –±–∏–∑–Ω–µ—Å–∞:**
```bash
curl -X GET http://localhost:8000/accounts/api/business-types/
```

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
curl -X POST http://localhost:8000/accounts/api/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤",
    "phone": "999123456",
    "company_name": "–¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è",
    "business_type": "1",
    "password": "testpass123",
    "agree_to_terms": true
  }'
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Django

```bash
python manage.py runserver --verbosity=2
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
python manage.py shell
```

```python
from apps.accounts.models import User
from apps.businesses.models import Business, BusinessType

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
User.objects.all().values('full_name', 'phone_number')

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–∑–Ω–µ—Å—ã
Business.objects.all().values('name', 'type__name', 'owner__full_name')

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –±–∏–∑–Ω–µ—Å–∞
BusinessType.objects.all().values('id', 'name')
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–¢–µ–ª–µ—Ñ–æ–Ω**: API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã +996
2. **–ì–æ—Ä–æ–¥**: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –≥–æ—Ä–æ–¥ –∏–∑ –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞
3. **–†–æ–ª—å**: –í—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç —Ä–æ–ª—å ADMIN
4. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü–æ–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (is_phone_verified=True)
5. **–ë–∏–∑–Ω–µ—Å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
6. **–¢–∏–ø—ã –±–∏–∑–Ω–µ—Å–∞**: –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ï—Å–ª–∏ –Ω–µ—Ç –≥–æ—Ä–æ–¥–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–π–¥–µ—Ç
- –ï—Å–ª–∏ –Ω–µ—Ç —Ç–∏–ø–æ–≤ –±–∏–∑–Ω–µ—Å–∞, –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å `create_business_types.py`
- –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ Wagtail –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å –∑–∞–ø—É—Å–∫—É Django shell

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Django
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ 